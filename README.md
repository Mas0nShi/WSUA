# WSUEs Automation Pipeline


[![Cron WSUEs Pipeline](https://github.com/Mas0nShi/WSUA/actions/workflows/cron-wsues-pipeline.yml/badge.svg?branch=main)](https://github.com/Mas0nShi/WSUA/actions/workflows/cron-wsues-pipeline.yml) [![Manual WSUEs Pipeline](https://github.com/Mas0nShi/WSUA/actions/workflows/manual-wsues-pipeline.yml/badge.svg?branch=main)](https://github.com/Mas0nShi/WSUA/actions/workflows/manual-wsues-pipeline.yml)



**Generate by LLM**: This README was generated by a language model, it's may not be fully accurate or up-to-date. Please verify the information before use.


An automated GitHub Actions pipeline for fetching and managing Windows Security Updates (WSUEs) data. This project provides both scheduled (Patch Tuesday) and manual data collection capabilities for all supported Windows products.

## üöÄ Features

- **Automated Patch Tuesday Collection**: Automatically fetches WSUEs data every second Tuesday of the month
- **Manual Data Fetching**: On-demand collection for specific dates and products
- **Multi-Product Support**: Covers all major Windows versions and Server editions
- **Data Compression**: Individual gzip compression for optimal storage and transfer
- **Release Management**: Automatic GitHub releases with compressed data files
- **Artifact Storage**: Configurable retention periods for different fetch types

## üìã Supported Windows Products

- Windows 10 21H2
- Windows 10 22H2
- Windows 11 22H2
- Windows 11 23H2
- Windows 11 24H2
- Windows Server 2019
- Windows Server 2022
- Windows Server 2025

## üîß Setup

### Prerequisites

1. **GitHub Repository Secrets**:
   - `WSUESTOKEN`: GitHub token for downloading the WSUEs Toolkit
   - `GITHUB_TOKEN`: Automatically provided by GitHub Actions

2. **Environment**: 
   - Repository environment named `WSUEs` configured in GitHub

### Repository Structure

```
.github/
‚îú‚îÄ‚îÄ workflows/
‚îÇ   ‚îú‚îÄ‚îÄ cron-wsues-pipeline.yml     # Scheduled automation
‚îÇ   ‚îî‚îÄ‚îÄ manual-wsues-pipeline.yml   # Manual triggers
‚îî‚îÄ‚îÄ actions/
    ‚îú‚îÄ‚îÄ check-patch-tuesday/        # Patch Tuesday detection
    ‚îú‚îÄ‚îÄ setup-wsues/                # WSUEs Toolkit setup
    ‚îú‚îÄ‚îÄ fetch-wsues-data/           # Data fetching logic
    ‚îú‚îÄ‚îÄ compress-files/             # File compression
    ‚îî‚îÄ‚îÄ create-release/             # Release creation
```

## ü§ñ Automated Workflows

### Scheduled Pipeline ([cron-wsues-pipeline.yml](.github/workflows/cron-wsues-pipeline.yml))

**Trigger**: Every Tuesday at 15:00 UTC

**Condition**: Only runs if today is Patch Tuesday (second Tuesday of the month)

**Process**:
1. Checks if today is Patch Tuesday
2. Sets up WSUEs tool and workspace
3. Fetches data for all supported Windows products
4. Compresses JSON files individually with gzip
5. Uploads artifacts (90-day retention)
6. Creates GitHub release with compressed files

### Manual Pipeline ([manual-wsues-pipeline.yml](.github/workflows/manual-wsues-pipeline.yml))

**Trigger**: Manual workflow dispatch

**Parameters**:
- `date`: Target date in YYYY-MM format
- `fetch_type`: 
  - `single`: Fetch data for one specific product
  - `all`: Fetch data for all supported products
- `product`: Required for single fetch type

**Outputs**:
- **Single fetch**: Individual product file (30-day retention)
- **All fetch**: Compressed archive with GitHub release (90-day retention)

## üîÑ Custom Actions

### Check Patch Tuesday ([.github/actions/check-patch-tuesday](.github/actions/check-patch-tuesday/action.yml))
Determines if the current date is the second Tuesday of the month (Microsoft's Patch Tuesday).

**Outputs**:
- `is-patch-tuesday`: Boolean indicating if today is Patch Tuesday
- `current-date`: Current date in YYYY-MM format
- `formatted-date`: Full date for display purposes

### Setup WSUEs ([.github/actions/setup-wsues](.github/actions/setup-wsues/action.yml))
Downloads and prepares the WSUEs Toolkit for data fetching.

**Features**:
- Downloads latest WSUEs Toolkit release from internal repository
- Extracts and verifies executable
- Creates necessary directory structure

### Fetch WSUEs Data ([.github/actions/fetch-wsues-data](.github/actions/fetch-wsues-data/action.yml))
Executes WSUEs tool to collect security update data.

**Modes**:
- `single`: Fetch specific product data
- `all`: Fetch data for all supported products

### Compress Files ([.github/actions/compress-files](.github/actions/compress-files/action.yml))
Compresses JSON files using gzip for efficient storage and transfer.

**Features**:
- Individual file compression
- Compression ratio reporting
- Organized output structure

### Create Release ([.github/actions/create-release](.github/actions/create-release/action.yml))
Creates GitHub releases with fetched and compressed data.

**Includes**:
- Automated release notes
- Usage instructions
- Compressed file attachments

## üì¶ Usage

### Accessing Data

#### From GitHub Releases
1. Navigate to the [Releases](releases) page
2. Download the `.gz` files you need
3. Decompress: `gunzip filename.json.gz`
4. Use the JSON data in your applications

#### From GitHub Actions Artifacts
1. Go to the [Actions](actions) tab
2. Select the relevant workflow run
3. Download artifacts from the run summary

### Manual Execution

1. Go to **Actions** ‚Üí **Manual WSUEs Pipeline**
2. Click **Run workflow**
3. Configure parameters:
   - **Date**: YYYY-MM format (e.g., "2024-01")
   - **Type**: Choose "single" or "all"
   - **Product**: Required only for single fetch
4. Click **Run workflow**

## üóìÔ∏è Schedule

The automated pipeline runs according to Microsoft's Patch Tuesday schedule:
- **Frequency**: Monthly
- **Day**: Second Tuesday of each month
- **Time**: 15:00 UTC (3:00 PM UTC)

## üõ†Ô∏è Development

### Local Testing

The individual actions can be tested locally using [act](https://github.com/nektos/act) or similar tools:

```bash
# Test patch tuesday check
act -j check-patch-tuesday

# Test manual pipeline
act workflow_dispatch -j manual-fetch
```

### Customization

To add support for additional Windows products:

1. Update the product list in [`manual-wsues-pipeline.yml`](.github/workflows/manual-wsues-pipeline.yml)
2. Ensure the WSUEs Tookit supports the new product
3. Test with manual execution

## üìä Data Format

The fetched data is provided in JSON format containing Windows security update information. Each file corresponds to a specific Windows product and date range.

For more details on the data structure, refer to the WSUEs Toolkit documentation.

## üîí Security

- All sensitive operations use GitHub secrets
- Repository environment protection is enabled
- Actions run on isolated Windows runners
- No persistent storage of credentials

## üìù License

This automation pipeline is provided as-is for Windows security update data collection. Please ensure compliance with Microsoft's terms of service when using this data.

## ü§ù Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Test with manual pipeline execution
5. Submit a pull request

## üìû Support

For issues related to:
- **Pipeline execution**: Check the Actions logs and create an issue
- **WSUEs Tookit**: Refer to the [WSUEs repository](https://github.com/Mas0nShi/WSUEs)
- **Data accuracy**: Verify against official Microsoft sources

---

**Note**: This project requires Windows runners due to the WSUEs tool dependency. Ensure your GitHub Actions plan supports Windows runner usage.